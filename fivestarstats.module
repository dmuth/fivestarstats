<?php
/**
* Fivestar Stats module.  This is used for determining voting statistics,
* as well as looking for abuse of the voting system.
*
* @author Douglas Muth <http://www.dmuth.org/>
*/

/**
* Create our menu.
*/
function fivestarstats_menu() {

	$retval = array();

	//
	// Our main menu item.
	//
	$retval["admin/settings/fivestarstats"] = array(
		"title" => "Fivestar Stats",
		"page callback" => "fivestarstats_main",
		"access arguments" => array("administer site configuration"),
		"type" => MENU_NORMAL_ITEM,
		
		);

	return($retval);

} // End of fivestarstats_menu()


/**
* Our permissions function.
* For now, we'll leave this empty.
*/
function fivestarstats_perm() {
	$retval = array();
	return($retval);
}


/**
* Our main function.  It returns the various reports.
*
* @return string The content of the page
*/
function fivestarstats_main() {

	$retval = "";

	$num = 5;

	$data = array();

	include("get_total_stats.inc.php");
	$data["total"] = fivestarstats_get_total_stats();

	include("get_ips.inc.php");
	$data["ips"] = fivestarstats_get_ips($num);

	include("get_user_stats.inc.php");
	$data["users"] = fivestarstats_get_user_stats($num);

	include("form.inc.php");
	$retval .= drupal_get_form("fivestarstats_form", $data);

	//$retval .= "<pre>" . print_r($data["users"]["top_posters"], true) . "</pre>"; // Debugging

	return($retval);

} // End of fivestarstats_main()


